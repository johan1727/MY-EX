# üß™ Gu√≠a de Prueba - My Ex Coach

## ‚úÖ Checklist de Configuraci√≥n

### 1Ô∏è‚É£ Instalar Dependencias
```bash
cd mobile-app
npm install
```
**Estado:** ‚è≥ En progreso...

---

### 2Ô∏è‚É£ Configurar Supabase

#### A. Obtener Credenciales
1. Ve a https://app.supabase.com
2. Abre tu proyecto (o crea uno nuevo llamado "my-ex-coach")
3. Ve a **Settings** ‚Üí **API**
4. Copia:
   - **Project URL** (ejemplo: `https://abcdefgh.supabase.co`)
   - **anon public** key (empieza con `eyJhbGci...`)

#### B. Actualizar .env
Edita el archivo `mobile-app/.env` y reemplaza:
```
EXPO_PUBLIC_SUPABASE_URL=https://TU-PROYECTO.supabase.co
EXPO_PUBLIC_SUPABASE_ANON_KEY=eyJhbGci...TU-KEY-AQUI
```

#### C. Ejecutar Migraciones SQL
1. En Supabase Dashboard, ve a **SQL Editor**
2. Crea una nueva query
3. Copia y pega el contenido de `supabase/migrations/20240523000000_initial_schema.sql`
4. Ejecuta (Run)
5. Repite con `supabase/migrations/20240524000000_add_streak_tracking.sql`

**Contenido de las migraciones:**

**Migraci√≥n 1 (inicial_schema.sql):**
```sql
-- Perfiles de usuario
create table if not exists profiles (
  id uuid references auth.users not null primary key,
  email text,
  goal text check (goal in ('move_on', 'get_back', 'learn')),
  coins int default 5,
  created_at timestamptz default now()
);

-- Historial de Chat
create table if not exists chat_messages (
  id bigint generated by default as identity primary key,
  user_id uuid references profiles(id) not null,
  sender text check (sender in ('user', 'ai')),
  content text,
  image_url text,
  is_analysis boolean default false,
  created_at timestamptz default now()
);

-- Seguridad RLS
alter table profiles enable row level security;
alter table chat_messages enable row level security;

create policy "Users can see own profile" on profiles for select using (auth.uid() = id);
create policy "Users can see own chats" on chat_messages for select using (auth.uid() = user_id);
create policy "Users can insert own chats" on chat_messages for insert with check (auth.uid() = user_id);
```

**Migraci√≥n 2 (add_streak_tracking.sql):**
```sql
-- Add streak tracking to profiles
alter table profiles add column if not exists streak_start_date timestamptz default now();
alter table profiles add column if not exists last_contact_date timestamptz;
```

---

### 3Ô∏è‚É£ Configurar Edge Function (Opcional para pruebas)

**Opci√≥n A: Configurar despu√©s (recomendado para pruebas r√°pidas)**
- La app funcionar√° sin el chat
- Puedes probar auth, onboarding, UI, etc.

**Opci√≥n B: Configurar ahora**
1. Instala Supabase CLI: https://supabase.com/docs/guides/cli
2. Ejecuta:
```bash
cd supabase
supabase login
supabase link --project-ref TU-PROJECT-REF
supabase functions deploy chat-with-coach
supabase secrets set GEMINI_API_KEY=AIzaSyBr-IEjF68VRGNZJI1MJsl4GYmoRjRsMKE
```

---

### 4Ô∏è‚É£ Iniciar la App

```bash
cd mobile-app
npx expo start
```

Opciones:
- Presiona `a` para Android (emulador o dispositivo)
- Presiona `i` para iOS (solo Mac)
- Presiona `w` para Web
- Escanea el QR con **Expo Go** app en tu tel√©fono

---

## üß™ Plan de Pruebas

### Test 1: Autenticaci√≥n ‚úÖ
1. Abre la app
2. Deber√≠as ver la pantalla de **Login/Signup**
3. Presiona "Sign Up"
4. Ingresa un email y contrase√±a
5. Presiona "Sign Up"
6. ‚úÖ Deber√≠as ser redirigido a **Onboarding**

### Test 2: Onboarding ‚úÖ
1. Selecciona un objetivo (ej: "Move On")
2. ‚úÖ Deber√≠as ser redirigido a la app principal (Tabs)

### Test 3: Navegaci√≥n ‚úÖ
1. Verifica que hay 3 tabs: **Coach**, **Tools**, **Profile**
2. Navega entre ellos
3. ‚úÖ Todos deber√≠an cargar sin errores

### Test 4: Profile & Streak ‚úÖ
1. Ve al tab **Profile**
2. Deber√≠as ver:
   - Tu objetivo seleccionado
   - Contador de racha (0 d√≠as al inicio)
   - Bot√≥n "Reset Streak"
   - Bot√≥n "Sign Out"
3. ‚úÖ Todo se muestra correctamente

### Test 5: Tools ‚úÖ
1. Ve al tab **Tools**
2. Presiona **Message Decoder**
3. ‚úÖ Deber√≠as ver la pantalla con opci√≥n de subir imagen o pegar texto

### Test 6: Panic Button ‚úÖ
1. En **Tools**, presiona **Panic Button**
2. Deber√≠as ver:
   - Recordatorios de por qu√© terminaron
   - Bot√≥n "I Still Want to Text Them"
3. Presiona el bot√≥n
4. ‚úÖ Deber√≠a iniciar el ejercicio de respiraci√≥n animado

### Test 7: Chat (requiere Edge Function) üí¨
1. Ve al tab **Coach**
2. Escribe un mensaje: "Hola, necesito ayuda"
3. Presiona enviar
4. ‚úÖ Deber√≠as recibir una respuesta del coach

### Test 8: Sign Out ‚úÖ
1. Ve a **Profile**
2. Presiona "Sign Out"
3. ‚úÖ Deber√≠as regresar a la pantalla de Login

### Test 9: Login Existente ‚úÖ
1. Ingresa el email y contrase√±a que usaste antes
2. Presiona "Sign In"
3. ‚úÖ Deber√≠as entrar directamente a la app (sin onboarding)

---

## üêõ Soluci√≥n de Problemas

### Error: "Cannot find module"
**Soluci√≥n:** Aseg√∫rate de que `npm install` termin√≥ correctamente.

### Error: "Invalid Supabase URL"
**Soluci√≥n:** Verifica que el `.env` tenga las credenciales correctas.

### Error: "Row Level Security"
**Soluci√≥n:** Aseg√∫rate de ejecutar las migraciones SQL en Supabase.

### El chat no responde
**Soluci√≥n:** 
1. Verifica que la Edge Function est√© desplegada
2. O ignora por ahora, el resto de la app funciona

### La app no inicia
**Soluci√≥n:**
```bash
# Limpia cache
npx expo start -c
```

---

## üìä Resultados Esperados

Al completar todas las pruebas, deber√≠as tener:
- ‚úÖ Autenticaci√≥n funcionando
- ‚úÖ Onboarding funcionando
- ‚úÖ Navegaci√≥n entre tabs
- ‚úÖ Profile con racha
- ‚úÖ Tools (Decoder y Panic Button)
- ‚úÖ Chat (si configuraste Edge Function)
- ‚úÖ Sign out y re-login

---

## üéâ ¬°Listo!

Si todos los tests pasan, tu app est√° **100% funcional** y lista para desarrollo adicional o despliegue.

**Siguiente paso:** Desplegar a Google Play con EAS Build
```bash
npx eas build --platform android
```
